<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="Madoko, version 0.6.3-beta" />
  <meta name="viewport" content="initial-scale=1.0" />
  <meta name="author" content="Lisa Goeller" />
  <link rel="stylesheet" type="text/css" href="madoko.css">
  <link rel="stylesheet" type="text/css" href="./writeup.css">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$']]},
       TeX: { 
         Macros: { mathid: ['\\mathit{#1\\hspace{0.1ex}}',1], mathkw: ['\\mathsf{#1}',1],
                   mathspace: ['\\hspace{#1pt}\\hspace{#1pt}\\hspace{#1pt}',1], mathindent: ['\\hspace{#1ex}',1], mathbr: ['\\\\'],
                 },
  
       }
    });
    MathJax.Hub.Register.StartupHook('TeX AMSmath Ready',function () { 
      MathJax.InputJax.TeX.Definitions.environment['mdMathprearray'] = ['AMSarray',null,null,null,'l','0em','0em'];
    });
  </script>
  <script type="text/javascript"
    src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</head>
<body class="madoko">

<h1 id="passwords-and-encryption"  data-line="8;passwords.md:1" ><span data-line="8;passwords.md::1"></span>Passwords and Encryption</h1>
<p data-line="8;passwords.md:2"><span data-line="8;passwords.md::2"></span><strong>Originally created by Lisa Goeller</strong><span data-line="8;passwords.md::2"></span>
</p>
<p class="indent" data-line="8;passwords.md:4"><span data-line="8;passwords.md::4"></span><em>``Passwords are like underwear. You shouldn&#39;t leave them out where
people can see them. You should change them regularly. And you shouldn&#39;t
loan them out to strangers.&quot;</em><span data-line="8;passwords.md::6"></span> <span data-line="8;passwords.md::6"></span><em>&#8212;<a href="http://security.calpoly.edu/sites/security/files/docs/posters/Passwords-Are-Like-Underwear-Poster.pdf">Anonymous</a></em><span data-line="8;passwords.md::7"></span>
</p><h2 id="introduction"  data-line="8;passwords.md:9" ><span data-line="8;passwords.md::9"></span>Introduction</h2>
<p data-line="8;passwords.md:11"><span data-line="8;passwords.md::11"></span>A weak password can create a hole in an otherwise completely secure
system. All it takes is one user with a simple password and someone who
knows their way around UNIX to compromise your system. As people
continue to create more sophisticated password crackers, it<span data-line="8;passwords.md::14"></span>&#39;<span data-line="8;passwords.md::14"></span>s becoming
easier and easier for passwords to be guessed. It is incredibly
important to make sure that your users have secure passwords to limit
security threats as much as possible.
</p>
<p class="indent" data-line="8;passwords.md:19"><span data-line="8;passwords.md::19"></span>It may seem hard to believe, but people will still choose weak passwords
if given the option. SplashData, a company that manages passwords, posts
its most common passwords every year. Take a look at the most common
passwords of 2013, according to SplashData:
</p>
<p class="indent" data-line="8;passwords.md:24"><span data-line="8;passwords.md::24"></span>1<span data-line="8;passwords.md::24"></span>.<span data-line="8;passwords.md::24"></span> 123456
</p>
<p class="indent" data-line="8;passwords.md:26"><span data-line="8;passwords.md::26"></span>2<span data-line="8;passwords.md::26"></span>.<span data-line="8;passwords.md::26"></span> password
</p>
<p class="indent" data-line="8;passwords.md:28"><span data-line="8;passwords.md::28"></span>3<span data-line="8;passwords.md::28"></span>.<span data-line="8;passwords.md::28"></span> 12345678
</p>
<p class="indent" data-line="8;passwords.md:30"><span data-line="8;passwords.md::30"></span>4<span data-line="8;passwords.md::30"></span>.<span data-line="8;passwords.md::30"></span> qwerty
</p>
<p class="indent" data-line="8;passwords.md:32"><span data-line="8;passwords.md::32"></span>5<span data-line="8;passwords.md::32"></span>.<span data-line="8;passwords.md::32"></span> abc123
</p>
<p class="indent" data-line="8;passwords.md:34"><span data-line="8;passwords.md::34"></span>6<span data-line="8;passwords.md::34"></span>.<span data-line="8;passwords.md::34"></span> 12356789
</p>
<p class="indent" data-line="8;passwords.md:36"><span data-line="8;passwords.md::36"></span>7<span data-line="8;passwords.md::36"></span>.<span data-line="8;passwords.md::36"></span> 111111
</p>
<p class="indent" data-line="8;passwords.md:38"><span data-line="8;passwords.md::38"></span>8<span data-line="8;passwords.md::38"></span>.<span data-line="8;passwords.md::38"></span> 1234567
</p>
<p class="indent" data-line="8;passwords.md:40"><span data-line="8;passwords.md::40"></span>9<span data-line="8;passwords.md::40"></span>.<span data-line="8;passwords.md::40"></span> iloveyou
</p>
<p class="indent" data-line="8;passwords.md:42"><span data-line="8;passwords.md::42"></span>10<span data-line="8;passwords.md::42"></span>.<span data-line="8;passwords.md::42"></span> adobe1234
</p>
<p class="indent" data-line="8;passwords.md:44"><span data-line="8;passwords.md::44"></span>As you can see, weak passwords are still VERY prevalent on the
interwebs. In this lab, we will explore what you can do with passwords
and encryption.
</p><h2 id="passwords"  data-line="8;passwords.md:48" ><span data-line="8;passwords.md::48"></span>Passwords</h2>
<p data-line="8;passwords.md:51"><span data-line="8;passwords.md::51"></span>The passwords on your system are stored in the <span data-line="8;passwords.md::51"></span><code class="code">/etc/passwd</code><span data-line="8;passwords.md::51"></span> and
<span data-line="8;passwords.md::52"></span><code class="code">/etc/shadow</code><span data-line="8;passwords.md::52"></span> files. The <span data-line="8;passwords.md::52"></span><code class="code">/etc/passwd</code><span data-line="8;passwords.md::52"></span> file is world readable because
many commands, like <span data-line="8;passwords.md::53"></span><code class="code">ls</code><span data-line="8;passwords.md::53"></span>, rely on it to display file ownerships and
similar characteristics. The <span data-line="8;passwords.md::54"></span><code class="code">/etc/passwd</code><span data-line="8;passwords.md::54"></span> contains account information
and stores passwords as a single ‘x<span data-line="8;passwords.md::55"></span>&#39;<span data-line="8;passwords.md::55"></span> character while the <span data-line="8;passwords.md::55"></span><code class="code">/etc/shadow</code><span data-line="8;passwords.md::55"></span>
file, which only gives root read and write permissions, contains the
encrypted passwords and personal information about the user. Both files
store this information in a single line of code for each user in their
respective files.
</p>
<p class="indent" data-line="8;passwords.md:61"><span data-line="8;passwords.md::61"></span>User accounts are not only limited to humans. If you take a look at
either your <span data-line="8;passwords.md::62"></span><code class="code">/etc/passwd</code><span data-line="8;passwords.md::62"></span> or <span data-line="8;passwords.md::62"></span><code class="code">etc/shadow</code><span data-line="8;passwords.md::62"></span> files, you<span data-line="8;passwords.md::62"></span>&#39;<span data-line="8;passwords.md::62"></span>ll see that they
contain more user accounts than there are human users on your machine.
Many commands, like <span data-line="8;passwords.md::64"></span><code class="code">amanda</code><span data-line="8;passwords.md::64"></span> need to have a user account in order to
execute properly.
</p>
<p class="indent" data-line="8;passwords.md:67"><span data-line="8;passwords.md::67"></span>If you<span data-line="8;passwords.md::67"></span>&#39;<span data-line="8;passwords.md::67"></span>d like to learn more about the formats of these files, 
<span data-line="8;passwords.md::68"></span><a href="http://tuxthink.blogspot.com/2012/03/look-into-etcpasswdetcshadow-and.html">this is a good resource</a><span data-line="8;passwords.md::68"></span>
</p><h3 id="john-the-ripper"  data-line="8;passwords.md:70" ><span data-line="8;passwords.md::70"></span>John the Ripper</h3>
<p data-line="8;passwords.md:73"><span data-line="8;passwords.md::73"></span>John the Ripper is a password cracking tool used by some administrators
to determine the strength of their users<span data-line="8;passwords.md::74"></span>&#39;<span data-line="8;passwords.md::74"></span> passwords. John checks your current 
passwords against its preloaded list of common passwords to
see how secure your system<span data-line="8;passwords.md::76"></span>&#39;<span data-line="8;passwords.md::76"></span>s passwords are.
</p>
<p class="indent" data-line="8;passwords.md:78"><span data-line="8;passwords.md::78"></span>As you know from the reading, John can run in regular, single, wordlist,
and incremental modes. Just to elaborate, single mode uses a dictionary
created out of a user<span data-line="8;passwords.md::80"></span>&#39;<span data-line="8;passwords.md::80"></span>s gecos fields, entries in the <span data-line="8;passwords.md::80"></span><code class="code">/etc/passwd</code><span data-line="8;passwords.md::80"></span> file
that contain general information about users like their real name and
contact information. In incremental mode, John will try all possible
variations of ASCII characters for passwords up to 13 characters long.
Just as a warning, John can take up a lot of CPU processing time and it
can sometimes take a couple days to crack a password.
</p>
<p class="indent" data-line="8;passwords.md:87"><span data-line="8;passwords.md::87"></span>Note: Many have been arrested for using John the Ripper on a network.
Make sure before running password crackers to always let the higher ups
know if you are not doing it on your own machine.
</p>
<p class="indent" data-line="8;passwords.md:91"><span data-line="8;passwords.md::91"></span>Now that you know a bit about John, try it out yourself!
</p>
<p class="indent" data-line="8;passwords.md:93"><span data-line="8;passwords.md::93"></span>Navigate to the nfs-mounted directory <span data-line="8;passwords.md::93"></span><code class="code">/mnt/local/passwordsLab</code><span data-line="8;passwords.md::93"></span>. In it, you 
should see a file called jackson.txt in your home directory. Take a
look at that file.
</p>
<p class="indent" data-line="8;passwords.md:97"><span data-line="8;passwords.md::97"></span>Recall from the readings what each of these fields are. What can you
tell about mike<span data-line="8;passwords.md::98"></span>&#39;<span data-line="8;passwords.md::98"></span>s account just from looking at this files? Run John
against the jackson.txt file.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:101"><code>/usr/sbin/john jackson.txt</code></pre>
<p data-line="8;passwords.md:103"><span data-line="8;passwords.md::103"></span>John will soon let you know it<span data-line="8;passwords.md::103"></span>&#39;<span data-line="8;passwords.md::103"></span>s completed its job. By default, John
runs through single crack mode first, then uses a wordlist with rules,
and finally goes for incremental mode. The first time John cracks a password, it
will display the result. It also stores the result in the <span data-line="8;passwords.md::106"></span><code class="code">.john/john.pot</code><span data-line="8;passwords.md::106"></span> file
in your home directory. To show them, you<span data-line="8;passwords.md::107"></span>&#39;<span data-line="8;passwords.md::107"></span>ll can run:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:109"><code>/usr/sbin/john --show jackson.txt</code></pre>
<p data-line="8;passwords.md:111"><span data-line="8;passwords.md::111"></span>Now you know mike<span data-line="8;passwords.md::111"></span>&#39;<span data-line="8;passwords.md::111"></span>s password<span data-line="8;passwords.md::111"></span>&#8212;<span data-line="8;passwords.md::111"></span>it<span data-line="8;passwords.md::111"></span>&#39;<span data-line="8;passwords.md::111"></span>s one of my favorite tunes!
</p>
<p class="indent" data-line="8;passwords.md:113"><span data-line="8;passwords.md::113"></span><strong>Note:</strong><span data-line="8;passwords.md::113"></span> For obvious reasons, there is not an actual user named mike with this
password on your system.
</p><h3 id="choosing-a-strong-password"  data-line="8;passwords.md:116" ><span data-line="8;passwords.md::116"></span>Choosing a Strong Password</h3>
<p data-line="8;passwords.md:118"><span data-line="8;passwords.md::118"></span>You<span data-line="8;passwords.md::118"></span>&#39;<span data-line="8;passwords.md::118"></span>re probably familiar with the basic requirements of a strong
password. It<span data-line="8;passwords.md::119"></span>&#39;<span data-line="8;passwords.md::119"></span>s generally accepted that a password should have a minimum
length of eight characters and contain at least one number, one
non-alphanumeric character, and one letter. It can be difficult coming
up with passwords on your own. The 
<span data-line="8;passwords.md::123"></span><a href="https://xkpasswd.net/s/">xkcd password generator</a><span data-line="8;passwords.md::123"></span> is a nice tool for doing so. 
</p>
<p class="indent" data-line="8;passwords.md:125"><span data-line="8;passwords.md::125"></span>Gentoo also offers some tools for random
password generation. We<span data-line="8;passwords.md::126"></span>&#39;<span data-line="8;passwords.md::126"></span>re going to look at one of them, <span data-line="8;passwords.md::126"></span><code class="code">passook</code><span data-line="8;passwords.md::126"></span>.
</p>
<p class="indent" data-line="8;passwords.md:128"><span data-line="8;passwords.md::128"></span>You can use <span data-line="8;passwords.md::128"></span><code class="code">passook</code><span data-line="8;passwords.md::128"></span> to generate some random passwords. The general
syntax for <span data-line="8;passwords.md::129"></span><code class="code">passook</code><span data-line="8;passwords.md::129"></span> is as follows:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:131"><code>passook [-n num] [-p plev] [-u usernames]</code></pre>
<p data-line="8;passwords.md:133"><span data-line="8;passwords.md::133"></span>where <span data-line="8;passwords.md::133"></span><code class="code">num</code><span data-line="8;passwords.md::133"></span> is the number of passwords you want to generate, <span data-line="8;passwords.md::133"></span><code class="code">plev</code><span data-line="8;passwords.md::133"></span> is
the pronunciation level, on a scale from 1 (few alphanumeric
characters) to 5 (all alphanumeric characters), and <span data-line="8;passwords.md::135"></span><code class="code">usernames</code><span data-line="8;passwords.md::135"></span> is
the path to the usernames file. If the <span data-line="8;passwords.md::136"></span><code class="code">usernames</code><span data-line="8;passwords.md::136"></span> option is included,
<span data-line="8;passwords.md::137"></span><code class="code">passook</code><span data-line="8;passwords.md::137"></span> will automaticlaly add the passwords it generates to the
usernames in the file.
</p>
<p class="indent" data-line="8;passwords.md:140"><span data-line="8;passwords.md::140"></span>For funsies, try generating a couple passwords with different
pronunciation levels.
</p><h3 id="pam-and-cracklib"  data-line="8;passwords.md:143" ><span data-line="8;passwords.md::143"></span>pam and cracklib</h3>
<p data-line="8;passwords.md:145"><span data-line="8;passwords.md::145"></span>Now that you<span data-line="8;passwords.md::145"></span>&#39;<span data-line="8;passwords.md::145"></span>ve seen what strong passwords look like, it<span data-line="8;passwords.md::145"></span>&#39;<span data-line="8;passwords.md::145"></span>s time to
ensure that all the passwords on your system will meet your own password
requirement, whatever that may be.
</p>
<p class="indent" data-line="8;passwords.md:149"><span data-line="8;passwords.md::149"></span><code class="code">pam</code><span data-line="8;passwords.md::149"></span>, the <span data-line="8;passwords.md::149"></span><code class="code">pluggable authentication module</code><span data-line="8;passwords.md::149"></span>, is used for authentication
between different services. <span data-line="8;passwords.md::150"></span><code class="code">pam</code><span data-line="8;passwords.md::150"></span> acts as a layer between authentication
services and the programs that need authentication before they can
proceed. It<span data-line="8;passwords.md::152"></span>&#39;<span data-line="8;passwords.md::152"></span>s used by tons of applications. Run the command below to see
the list of applications with <span data-line="8;passwords.md::153"></span><code class="code">pam</code><span data-line="8;passwords.md::153"></span> support.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:155"><code>sudo ldd /{,usr/}{bin,sbin}/* | grep -B 5 libpam | grep &#39;^/&#39;</code></pre>
<p data-line="8;passwords.md:157"><span data-line="8;passwords.md::157"></span>You can alternatively see the list of packages that depend on <span data-line="8;passwords.md::157"></span><code class="code">pam</code><span data-line="8;passwords.md::157"></span>:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:159"><code>equery depends pam</code></pre>
<p data-line="8;passwords.md:161"><span data-line="8;passwords.md::161"></span>As you can see, <span data-line="8;passwords.md::161"></span><code class="code">pam</code><span data-line="8;passwords.md::161"></span> is a very important part of your system. <span data-line="8;passwords.md::161"></span><code class="code">pam</code><span data-line="8;passwords.md::161"></span>&#39;<span data-line="8;passwords.md::161"></span>s
functions can be roughly divided into four jobs:
authentication, account, session, and password. Authentication makes
sure that the user has valid credentials, account checks whether the
user has permission to access whatever they<span data-line="8;passwords.md::165"></span>&#39;<span data-line="8;passwords.md::165"></span>re trying to do, session
builds up the environment, and password is for updating and modifying a
user<span data-line="8;passwords.md::167"></span>&#39;<span data-line="8;passwords.md::167"></span>s account information.
</p>
<p class="indent para-continue" data-line="8;passwords.md:169"><span data-line="8;passwords.md::169"></span><code class="code">cracklib</code><span data-line="8;passwords.md::169"></span> is an add-on feature that can be used to enhance
<span data-line="8;passwords.md::170"></span><code class="code">pam&#39;s authentication</code><span data-line="8;passwords.md::170"></span> function, forcing users to create stronger
passwords. We will explore some of these actions now.
</p>
<ol class="loose" data-line="8;passwords.md:173">
<li data-line="8;passwords.md:173">
<p data-line="8;passwords.md:173"><span data-line="8;passwords.md::173"></span>Go to <span data-line="8;passwords.md::173"></span><code class="code">/etc/pam.d/passwd</code><span data-line="8;passwords.md::173"></span> and edit it so that it somewhat resembles
the code below.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:176"><code>auth     required pam_unix.so shadow nullok
account  required pam_unix.so
password required pam_cracklib.so retry=3 minlen=8 enforce_for_root
password required pam_unix.so md5 use_authtok
session  required pam_unix.so</code></pre>
<p data-line="8;passwords.md:182"><span data-line="8;passwords.md::182"></span>These are just some example options. The <span data-line="8;passwords.md::182"></span><code class="code">retry=3</code><span data-line="8;passwords.md::182"></span> command gives the
user three tries to get a proper password and <span data-line="8;passwords.md::183"></span><code class="code">minlen=8</code><span data-line="8;passwords.md::183"></span> requires a
password that is at least eight characters long. Normally these
options only enforce these requirements for normal users. Adding the
<span data-line="8;passwords.md::186"></span><code class="code">enforce_for_root</code><span data-line="8;passwords.md::186"></span> option forces the root user to follow the
password requirements as everyone else. To see more options, simply
type <span data-line="8;passwords.md::188"></span><code class="code">man pam_cracklib</code><span data-line="8;passwords.md::188"></span> into the command line.
</p></li>
<li data-line="8;passwords.md:190">
<p data-line="8;passwords.md:190"><span data-line="8;passwords.md::190"></span>Create a fake user <span data-line="8;passwords.md::190"></span><code class="code">maninthemirror</code><span data-line="8;passwords.md::190"></span>.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:192"><code>sudo useradd maninthemirror</code></pre>
<p data-line="8;passwords.md:194"><span data-line="8;passwords.md::194"></span>Now try giving <span data-line="8;passwords.md::194"></span><code class="code">maninthemirror</code><span data-line="8;passwords.md::194"></span> a password.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:196"><code>sudo passwd maninthemirror</code></pre>
<p data-line="8;passwords.md:198"><span data-line="8;passwords.md::198"></span>You<span data-line="8;passwords.md::198"></span>&#39;<span data-line="8;passwords.md::198"></span>ll notice that if you try to enter a password that doesn<span data-line="8;passwords.md::198"></span>&#39;<span data-line="8;passwords.md::198"></span>t meet
the minimum requirements that you described in your
<span data-line="8;passwords.md::200"></span><code class="code">/etc/pam.d/passwd</code><span data-line="8;passwords.md::200"></span> file then you will be unable to set
<span data-line="8;passwords.md::201"></span><code class="code">maninthemirror&#39;s</code><span data-line="8;passwords.md::201"></span> password. <span data-line="8;passwords.md::201"></span><code class="code">cracklib</code><span data-line="8;passwords.md::201"></span> is thus a very powerful tool
to secure your system.
</p></li></ol>
<h3 id="aside--password-dictionaries"  data-line="8;passwords.md:204" ><span data-line="8;passwords.md::204"></span>Aside: password dictionaries</h3>
<p data-line="8;passwords.md:207"><span data-line="8;passwords.md::207"></span><code class="code">cracklib</code><span data-line="8;passwords.md::207"></span> comes equipped with a simple dictionary, <span data-line="8;passwords.md::207"></span><code class="code">cracklib-small</code><span data-line="8;passwords.md::207"></span>.
This is a basic set of words to run your potential passwords against. On
the <span data-line="8;passwords.md::209"></span><code class="code">cracklib</code><span data-line="8;passwords.md::209"></span> download page, there are plenty of other wordlists that
you can download and use to test the strength of your passwords. All of
your dictionaries are automatically stored in <span data-line="8;passwords.md::211"></span><code class="code">/usr/share/dict</code><span data-line="8;passwords.md::211"></span>,
including the <span data-line="8;passwords.md::212"></span><code class="code">words</code><span data-line="8;passwords.md::212"></span> dictionary that comes as a default on all Unix
systems and is used by word processors like <span data-line="8;passwords.md::213"></span><code class="code">vim</code><span data-line="8;passwords.md::213"></span> for spellchecking.
If you add another dictionary, you can have cracklib include this
dictionary and all the other dictionaries when checking password
strength simply by typing this command:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:218"><code>create-cracklib-dict /usr/share/dict/*</code></pre>
<p data-line="8;passwords.md:220"><span data-line="8;passwords.md::220"></span><code class="code">create-cracklib-dict</code><span data-line="8;passwords.md::220"></span> takes wordlist files and converts them into
<span data-line="8;passwords.md::221"></span><code class="code">cracklib</code><span data-line="8;passwords.md::221"></span> dictionaries so that <span data-line="8;passwords.md::221"></span><code class="code">cracklib</code><span data-line="8;passwords.md::221"></span> can use them. <span data-line="8;passwords.md::221"></span><code class="code">cracklib</code><span data-line="8;passwords.md::221"></span>
creates three files in your <span data-line="8;passwords.md::222"></span><code class="code">/usr/lib</code><span data-line="8;passwords.md::222"></span> directory:
<span data-line="8;passwords.md::223"></span><code class="code">cracklib_dict.hwm, cracklib_dict.pwd</code><span data-line="8;passwords.md::223"></span> and <span data-line="8;passwords.md::223"></span><code class="code">cracklib_dict.pwi</code><span data-line="8;passwords.md::223"></span>. These
are the files that cracklib looks up whenever it<span data-line="8;passwords.md::224"></span>&#39;<span data-line="8;passwords.md::224"></span>s doing a check.
</p>
<p class="indent" data-line="8;passwords.md:226"><span data-line="8;passwords.md::226"></span>When you run <span data-line="8;passwords.md::226"></span><code class="code">create-cracklib-dict</code><span data-line="8;passwords.md::226"></span> you<span data-line="8;passwords.md::226"></span>&#39;<span data-line="8;passwords.md::226"></span>ll see that two numbers are
displayed. The first is the number of words that <span data-line="8;passwords.md::227"></span><code class="code">cracklib</code><span data-line="8;passwords.md::227"></span> found in
your wordlist. The second is the number of words from that file that it
added to its dictionary.
</p><h2 id="encrypting-files"  data-line="8;passwords.md:231" ><span data-line="8;passwords.md::231"></span>Encrypting Files</h2>
<p data-line="8;passwords.md:233"><span data-line="8;passwords.md::233"></span>We<span data-line="8;passwords.md::233"></span>&#39;<span data-line="8;passwords.md::233"></span>ve seen how to use UNIX permissions to restrict access to files. 
There is another way to protect a file: encryption. There
are a couple times when you should choose to encrypt files instead of relying on
UNIX permissions. Any personal information on your computer like financial
records or your social security number should definitely be encrypted.
You should also encrypt files if you store files that have business
information and company secrets on your computer. In this lab, we<span data-line="8;passwords.md::239"></span>&#39;<span data-line="8;passwords.md::239"></span>ll
look at encrypting files using <span data-line="8;passwords.md::240"></span><code class="code">openssl</code><span data-line="8;passwords.md::240"></span> or <span data-line="8;passwords.md::240"></span><code class="code">gnupg</code><span data-line="8;passwords.md::240"></span>.
</p><h3 id="types-of-encryptions"  data-line="8;passwords.md:242" ><span data-line="8;passwords.md::242"></span>Types of Encryptions</h3>
<p data-line="8;passwords.md:245"><span data-line="8;passwords.md::245"></span>It may be helpful for you to see what types of encryption algorithms you
already have on your system. These are the ciphers included on your
kernel.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:249"><code>cat /proc/crypto | grep name</code></pre>
<p data-line="8;passwords.md:251"><span data-line="8;passwords.md::251"></span>The US standard for data encryption is <span data-line="8;passwords.md::251"></span><code class="code">aes</code><span data-line="8;passwords.md::251"></span>. <span data-line="8;passwords.md::251"></span><code class="code">des</code><span data-line="8;passwords.md::251"></span>, the
<span data-line="8;passwords.md::252"></span><code class="code">Data Encryption Standard</code><span data-line="8;passwords.md::252"></span>, was the original standard of the National
Institute of Standards and Technology. As time passed though, people
began to see the flaws of <span data-line="8;passwords.md::254"></span><code class="code">des</code><span data-line="8;passwords.md::254"></span>: namely that <span data-line="8;passwords.md::254"></span><code class="code">des</code><span data-line="8;passwords.md::254"></span> used only a 56-bit
data encryption key. In 1999, Deep Crack and distributed.net broke a
<span data-line="8;passwords.md::256"></span><code class="code">des</code><span data-line="8;passwords.md::256"></span> key in 22 hours, revealing how weak <span data-line="8;passwords.md::256"></span><code class="code">des</code><span data-line="8;passwords.md::256"></span> encryptions were. Since
then, <span data-line="8;passwords.md::257"></span><code class="code">des</code><span data-line="8;passwords.md::257"></span> has been replaced by <span data-line="8;passwords.md::257"></span><code class="code">aes</code><span data-line="8;passwords.md::257"></span>, the
<span data-line="8;passwords.md::258"></span><code class="code">Advanced Encryption System</code><span data-line="8;passwords.md::258"></span>. This new algorithm uses a 128-bit block
size, but has key sizes that can be either 128, 192, or 256 bits. There
are many other encryption algorithms out there.
</p>
<p class="indent" data-line="8;passwords.md:262"><span data-line="8;passwords.md::262"></span>In the next section, we will be using OpenSSL. Take a look at what
encryption algorithms are prebuilt into OpenSSL.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:265"><code>openssl ciphers -v</code></pre><h3 id="openssl"  data-line="8;passwords.md:267" ><span data-line="8;passwords.md::267"></span>OpenSSL</h3>
<p data-line="8;passwords.md:270"><span data-line="8;passwords.md::270"></span>OpenSSL implements the TLS and SSL protocols and doubles as an
encryption library. OpenSSL allows users to securely encrypt files. To
ensure that everything functions properly and no errors arise, it<span data-line="8;passwords.md::272"></span>&#39;<span data-line="8;passwords.md::272"></span>s best
to have an ingoing and outgoing destination for your encrypted file. The
OpenSSL encryption syntax looks like this:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:276"><code>openssl [encryption type] -in file-to-encrypt -out encrypted-file</code></pre>
<p data-line="8;passwords.md:278"><span data-line="8;passwords.md::278"></span>Try it out for yourself. Create a file <span data-line="8;passwords.md::278"></span><code class="code">file.txt</code><span data-line="8;passwords.md::278"></span> and write a secret
message inside. Encrypt the file using OpenSSL.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:281"><code>openssl enc -aes256 -in file.txt -out encrypted.txt</code></pre>
<p data-line="8;passwords.md:283"><span data-line="8;passwords.md::283"></span>This will encrypt your file using AES with a 256-bit key. You<span data-line="8;passwords.md::283"></span>&#39;<span data-line="8;passwords.md::283"></span>ll be prompted
to enter a passphrase. This is the phrase you<span data-line="8;passwords.md::284"></span>&#39;<span data-line="8;passwords.md::284"></span>ll use to decrypt the
file, so don<span data-line="8;passwords.md::285"></span>&#39;<span data-line="8;passwords.md::285"></span>t forget it! Once you<span data-line="8;passwords.md::285"></span>&#39;<span data-line="8;passwords.md::285"></span>ve done this, <span data-line="8;passwords.md::285"></span><code class="code">rm file.txt</code><span data-line="8;passwords.md::285"></span>, the old
file, and <span data-line="8;passwords.md::286"></span><code class="code">less encrypted.txt</code><span data-line="8;passwords.md::286"></span>. You<span data-line="8;passwords.md::286"></span>&#39;<span data-line="8;passwords.md::286"></span>ll see you can<span data-line="8;passwords.md::286"></span>&#39;<span data-line="8;passwords.md::286"></span>t read your secret
now that your file has been encrypted. Looks like you<span data-line="8;passwords.md::287"></span>&#39;<span data-line="8;passwords.md::287"></span>ll have to decrypt
the file.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:290"><code>openssl enc -d -aes256 -in encrypted.txt -out normal.txt
cat normal.txt</code></pre>
<p data-line="8;passwords.md:293"><span data-line="8;passwords.md::293"></span>You can now read your secret!
</p><h3 id="gnupg"  data-line="8;passwords.md:295" ><span data-line="8;passwords.md::295"></span>gnupg</h3>
<p data-line="8;passwords.md:298"><span data-line="8;passwords.md::298"></span><code class="code">gnupg</code><span data-line="8;passwords.md::298"></span> or GNU privacy guard, is another tool that can encrypt
files. In this case, we are going to use a symmetric-key cipher, which
means that both the author and recipient will use the same key for
encryption and decryption. Both parties need access to the public key in
order to send and receive the message, which is the biggest drawback to
the symmetric cipher. To specify a symmetric cipher, add the <span data-line="8;passwords.md::303"></span><code class="code">-c</code><span data-line="8;passwords.md::303"></span> option
while encrypting. To encrypt a file, run
</p>
<pre class="para-block para-block" data-line="8;passwords.md:306"><code>gpg -c --cipher-algo AES256 filename</code></pre>
<p data-line="8;passwords.md:308"><span data-line="8;passwords.md::308"></span>You will then be asked for a passphrase. After doing this, you<span data-line="8;passwords.md::308"></span>&#39;<span data-line="8;passwords.md::308"></span>ll see
that a file, filename.gpg, has been added to the directory. Now that you
have the encrypted file, you no longer need the old file so feel free to
<span data-line="8;passwords.md::311"></span><code class="code">rm filename</code><span data-line="8;passwords.md::311"></span>. If you <span data-line="8;passwords.md::311"></span><code class="code">cat</code><span data-line="8;passwords.md::311"></span> the new filename.gpg file, you can see that
the information within it is encrypted.
</p>
<p class="indent" data-line="8;passwords.md:314"><span data-line="8;passwords.md::314"></span>Unencrypting a file is as easy as encrypting it!
</p>
<pre class="para-block para-block" data-line="8;passwords.md:316"><code>gpg filename.gpg</code></pre>
<p data-line="8;passwords.md:318"><span data-line="8;passwords.md::318"></span>You may be asked if you want to overwrite the original, unencrypted file. If you
say <span data-line="8;passwords.md::319"></span>&#8220;no&#8221;<span data-line="8;passwords.md::319"></span>, then gpg will prompt you to enter another file name. There are plenty
of other types of encryption that you can run. Simply look at the man page for
more details.
</p><h2 id="activity"  data-line="8;passwords.md:323" ><span data-line="8;passwords.md::323"></span>Activity</h2>
<p data-line="8;passwords.md:325"><span data-line="8;passwords.md::325"></span>One of your close friends, Michael, has recently passed away. On his
deathbed, he asked that you retrieve some important data from the file
<span data-line="8;passwords.md::327"></span><code class="code">lastwords</code><span data-line="8;passwords.md::327"></span> on his account. Copy his home directory to yours, so that you can
analyze it:
</p>
<p class="indent" data-line="8;passwords.md:330"><span data-line="8;passwords.md::330"></span><code class="code">sudo cp -r /mnt/local/passwordLab/michael ~/</code><span data-line="8;passwords.md::330"></span>
</p>
<p class="indent" data-line="8;passwords.md:332"><span data-line="8;passwords.md::332"></span><strong>Be sure to copy the directory</strong><span data-line="8;passwords.md::332"></span>, so you don<span data-line="8;passwords.md::332"></span>&#39;<span data-line="8;passwords.md::332"></span>t spoil everyone else<span data-line="8;passwords.md::332"></span>&#39;<span data-line="8;passwords.md::332"></span>s fun when you
modify the files
</p>
<p class="indent" data-line="8;passwords.md:335"><span data-line="8;passwords.md::335"></span>Now see if you can read his last words!
</p><h3 id="notes"  data-line="8;passwords.md:338" ><span data-line="8;passwords.md::338"></span>Notes</h3>
<p data-line="8;passwords.md:340"><span data-line="8;passwords.md::340"></span>As always, judicious googling is your friend! Here are some other tips
just in case things go wrong:
</p>
<p class="indent" data-line="8;passwords.md:343"><span data-line="8;passwords.md::343"></span>If you can<span data-line="8;passwords.md::343"></span>&#39;<span data-line="8;passwords.md::343"></span>t get something to work, make sure that you have permissions
for that file or directory.
</p><h2 id="bonus-activity"  data-line="8;passwords.md:346" ><span data-line="8;passwords.md::346"></span>Bonus activity</h2>
<p data-line="8;passwords.md:348"><span data-line="8;passwords.md::348"></span>Set up mutt to send encrypted email using gpg public/private keys.
</p><h3 id="encrypted-mail"  data-line="8;passwords.md:350;encrypted_mail.md:1" ><span data-line="8;passwords.md:350;encrypted_mail.md::1"></span>Encrypted Mail</h3>
<p data-line="8;passwords.md:350;encrypted_mail.md:3"><span data-line="8;passwords.md:350;encrypted_mail.md::3"></span>I bet you<span data-line="8;passwords.md:350;encrypted_mail.md::3"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::3"></span>ve always wanted to send encrypted emails. Well, this is the
chance to live your dreams!
</p>
<p class="indent" data-line="8;passwords.md:350;encrypted_mail.md:6"><span data-line="8;passwords.md:350;encrypted_mail.md::6"></span>It<span data-line="8;passwords.md:350;encrypted_mail.md::6"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::6"></span>s pretty easy to set up <span data-line="8;passwords.md:350;encrypted_mail.md::6"></span><code class="code">gpg</code><span data-line="8;passwords.md:350;encrypted_mail.md::6"></span> on <span data-line="8;passwords.md:350;encrypted_mail.md::6"></span><code class="code">mutt</code><span data-line="8;passwords.md:350;encrypted_mail.md::6"></span> once you have your own <span data-line="8;passwords.md:350;encrypted_mail.md::6"></span><code class="code">gpg</code><span data-line="8;passwords.md:350;encrypted_mail.md::6"></span>
public key, but the process of getting this key can be a bit tricky.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:9"><code>gpg --gen-key</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:11"><span data-line="8;passwords.md:350;encrypted_mail.md::11"></span>You will then be prompted to to select what kind of key you want. Go
ahead and select the default, <span data-line="8;passwords.md:350;encrypted_mail.md::12"></span><code class="code">RSA and RSA</code><span data-line="8;passwords.md:350;encrypted_mail.md::12"></span>. Then select 2048 as your
keysize and choose how long you want your key to last. After that,
you<span data-line="8;passwords.md:350;encrypted_mail.md::14"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::14"></span>ll need to input some user information. You can use real information
or fake–this just makes it easier to locate your key. You<span data-line="8;passwords.md:350;encrypted_mail.md::15"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::15"></span>ll be asked to
enter in a passphrase. Make sure you remember what this password is. If
you lose it, you can<span data-line="8;passwords.md:350;encrypted_mail.md::17"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::17"></span>t get it back! Once you<span data-line="8;passwords.md:350;encrypted_mail.md::17"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::17"></span>ve filled out all the
necessary information, GnuPG will generate your key. This might take a
while. You can speed the process up by keyboard mashing. <span data-line="8;passwords.md:350;encrypted_mail.md::19"></span><code class="code">gpg</code><span data-line="8;passwords.md:350;encrypted_mail.md::19"></span> generates
your new key by using the time interval between keystrokes.
</p>
<p class="indent" data-line="8;passwords.md:350;encrypted_mail.md:22"><span data-line="8;passwords.md:350;encrypted_mail.md::22"></span>You can also log into another session and run the following command, to generate
some disk activity:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:25"><code>sudo dd if=/dev/sda of=/dev/zero</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:27"><span data-line="8;passwords.md:350;encrypted_mail.md::27"></span>Once your key is generated, you can run the command:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:29"><code>gpg --list-keys</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:31"><span data-line="8;passwords.md:350;encrypted_mail.md::31"></span>You should see your new key within your list of keys. For example:
</p>
<pre class="para-block fenced para-block" data-line="8;passwords.md:350;encrypted_mail.md:33" data-line-code="8;passwords.md:350;encrypted_mail.md:34"><code data-line="8;passwords.md:350;encrypted_mail.md:34">pub   2048R/F95D97F2 2014-11-04 [expires: 2014-12-14]
uid       [ultimate] Ben Wiedermann &lt;ben@adminvm5.sys.cs.hmc.edu&gt;
sub   2048R/A4F464B6 2014-11-04 [expires: 2014-12-14]</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:39"><span data-line="8;passwords.md:350;encrypted_mail.md::39"></span>You<span data-line="8;passwords.md:350;encrypted_mail.md::39"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::39"></span>ll see that there is the <span data-line="8;passwords.md:350;encrypted_mail.md::39"></span><code class="code">pub</code><span data-line="8;passwords.md:350;encrypted_mail.md::39"></span>lic key and the <span data-line="8;passwords.md:350;encrypted_mail.md::39"></span><code class="code">sub</code><span data-line="8;passwords.md:350;encrypted_mail.md::39"></span>key of the <span data-line="8;passwords.md:350;encrypted_mail.md::39"></span><code class="code">pub</code><span data-line="8;passwords.md:350;encrypted_mail.md::39"></span> key.
Usually people use the <span data-line="8;passwords.md:350;encrypted_mail.md::40"></span><code class="code">pub</code><span data-line="8;passwords.md:350;encrypted_mail.md::40"></span> key for signing and the <span data-line="8;passwords.md:350;encrypted_mail.md::40"></span><code class="code">sub</code><span data-line="8;passwords.md:350;encrypted_mail.md::40"></span> key for encryption.
</p>
<p class="indent" data-line="8;passwords.md:350;encrypted_mail.md:42"><span data-line="8;passwords.md:350;encrypted_mail.md::42"></span>When you need to use your key for other commands (e.g., the commands below), you
want the value after the slash for the <span data-line="8;passwords.md:350;encrypted_mail.md::43"></span><code class="code">pub</code><span data-line="8;passwords.md:350;encrypted_mail.md::43"></span> key , e.g., <span data-line="8;passwords.md:350;encrypted_mail.md::43"></span><code class="code">F95D97F2</code><span data-line="8;passwords.md:350;encrypted_mail.md::43"></span>.
</p>
<p class="indent" data-line="8;passwords.md:350;encrypted_mail.md:45"><span data-line="8;passwords.md:350;encrypted_mail.md::45"></span>Before doing anything else, you should create a revocation key. This
allows you to revoke your key in the event of a disaster.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:48"><code>gpg --output revoke.asc --gen-revoke &lt;your key&gt;</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:50"><span data-line="8;passwords.md:350;encrypted_mail.md::50"></span>Select <span data-line="8;passwords.md:350;encrypted_mail.md::50"></span>&#8220;1“ and &#8221;<span data-line="8;passwords.md:350;encrypted_mail.md::50"></span>yes<span data-line="8;passwords.md:350;encrypted_mail.md::50"></span>&quot;<span data-line="8;passwords.md:350;encrypted_mail.md::50"></span>.
</p>
<p class="indent" data-line="8;passwords.md:350;encrypted_mail.md:52"><span data-line="8;passwords.md:350;encrypted_mail.md::52"></span>Now you<span data-line="8;passwords.md:350;encrypted_mail.md::52"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::52"></span>re ready to integrate <span data-line="8;passwords.md:350;encrypted_mail.md::52"></span><code class="code">gnupg</code><span data-line="8;passwords.md:350;encrypted_mail.md::52"></span> into <span data-line="8;passwords.md:350;encrypted_mail.md::52"></span><code class="code">mutt</code><span data-line="8;passwords.md:350;encrypted_mail.md::52"></span>. Go into your sample
<span data-line="8;passwords.md:350;encrypted_mail.md::53"></span><code class="code">mutt</code><span data-line="8;passwords.md:350;encrypted_mail.md::53"></span> configuration files. <span data-line="8;passwords.md:350;encrypted_mail.md::53"></span><code class="code">mutt</code><span data-line="8;passwords.md:350;encrypted_mail.md::53"></span> comes pre-installed with a <span data-line="8;passwords.md:350;encrypted_mail.md::53"></span><code class="code">gnupg</code><span data-line="8;passwords.md:350;encrypted_mail.md::53"></span>
config file within the sample directory.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:56"><code>cd /usr/share/doc/mutt-*/samples</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:58"><span data-line="8;passwords.md:350;encrypted_mail.md::58"></span>Inside this directory, you should see a <span data-line="8;passwords.md:350;encrypted_mail.md::58"></span><code class="code">gpg.rc</code><span data-line="8;passwords.md:350;encrypted_mail.md::58"></span> file. Copy this file
into your home directory so that it<span data-line="8;passwords.md:350;encrypted_mail.md::59"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::59"></span>ll work for your <span data-line="8;passwords.md:350;encrypted_mail.md::59"></span><code class="code">mutt</code><span data-line="8;passwords.md:350;encrypted_mail.md::59"></span>.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:61"><code>cd /usr/share/doc/mutt-*/samples/gpg.rc ~/.gpgrc</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:63"><span data-line="8;passwords.md:350;encrypted_mail.md::63"></span>If there is a .bz2 extension after it, you won<span data-line="8;passwords.md:350;encrypted_mail.md::63"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::63"></span>t be able to copy it to
your home directory until you unzip it.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:66"><code>bzip2 -d gpg.rc.bz2</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:68"><span data-line="8;passwords.md:350;encrypted_mail.md::68"></span>Add the following lines to the <span data-line="8;passwords.md:350;encrypted_mail.md::68"></span><code class="code">.muttrc</code><span data-line="8;passwords.md:350;encrypted_mail.md::68"></span> file in your home directory:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:70"><code>source = ~./gpgrc
set pgp_use_gpg_agent = yes
set pgp_sign_as = &lt;yourkey&gt; 
set pgp_timeout = 3600
set crypt_replyencrypt = yes</code></pre><h4 id="troubleshooting" data-line="8;passwords.md:350;encrypted_mail.md:76" ><span data-line="8;passwords.md:350;encrypted_mail.md::76"></span>Troubleshooting</h4>
<p data-line="8;passwords.md:350;encrypted_mail.md:77"><span data-line="8;passwords.md:350;encrypted_mail.md::77"></span>It can take a while to generate enough entropy to create an GnuPG key.
Be patient and if it doesn<span data-line="8;passwords.md:350;encrypted_mail.md::78"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::78"></span>t work, try making another one or consulting
the internet.
</p><h3 id="find-a-friend"  data-line="8;passwords.md:350;encrypted_mail.md:81" ><span data-line="8;passwords.md:350;encrypted_mail.md::81"></span>Find a Friend</h3>
<p data-line="8;passwords.md:350;encrypted_mail.md:83"><span data-line="8;passwords.md:350;encrypted_mail.md::83"></span>Look around you and find a buddy to send an email to.
</p>
<p class="indent para-continue" data-line="8;passwords.md:350;encrypted_mail.md:85"><span data-line="8;passwords.md:350;encrypted_mail.md::85"></span>The people you<span data-line="8;passwords.md:350;encrypted_mail.md::85"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::85"></span>re sending mail to need to have your key or they won<span data-line="8;passwords.md:350;encrypted_mail.md::85"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::85"></span>t be
able to read the mail they receive from you. There are two ways to do
this: creating an ASCII version of your key or uploading your key onto a
keyserver.
</p>
<ol class="loose" data-line="8;passwords.md:350;encrypted_mail.md:90">
<li data-line="8;passwords.md:350;encrypted_mail.md:90">
<p data-line="8;passwords.md:350;encrypted_mail.md:90"><span data-line="8;passwords.md:350;encrypted_mail.md::90"></span>ASCII Version
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:92"><code>gpg --armor --output public.key --export &lt;Key ID&gt;</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:94"><span data-line="8;passwords.md:350;encrypted_mail.md::94"></span><code class="code">public.key</code><span data-line="8;passwords.md:350;encrypted_mail.md::94"></span> can be whatever name you want. It<span data-line="8;passwords.md:350;encrypted_mail.md::94"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::94"></span>s helpful to have it
be something that<span data-line="8;passwords.md:350;encrypted_mail.md::95"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::95"></span>s easily identifiable.
</p>
<p data-line="8;passwords.md:350;encrypted_mail.md:97"><span data-line="8;passwords.md:350;encrypted_mail.md::97"></span><strong>TODO:</strong><span data-line="8;passwords.md:350;encrypted_mail.md::97"></span> put the public key in NFS
</p>
<p data-line="8;passwords.md:350;encrypted_mail.md:99"><span data-line="8;passwords.md:350;encrypted_mail.md::99"></span>Once that<span data-line="8;passwords.md:350;encrypted_mail.md::99"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::99"></span>s done, put your key in the NFS-mounted directory 
<span data-line="8;passwords.md:350;encrypted_mail.md::100"></span><code class="code">/mnt/local/keys</code><span data-line="8;passwords.md:350;encrypted_mail.md::100"></span>. You can also email your key to your friend
Once you<span data-line="8;passwords.md:350;encrypted_mail.md::101"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::101"></span>ve done that, all they have to
do is import it:
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:104"><code>gpg --import public.key</code></pre></li>
<li data-line="8;passwords.md:350;encrypted_mail.md:106">
<p data-line="8;passwords.md:350;encrypted_mail.md:106"><span data-line="8;passwords.md:350;encrypted_mail.md::106"></span>Keyservers
</p>
<p data-line="8;passwords.md:350;encrypted_mail.md:108"><span data-line="8;passwords.md:350;encrypted_mail.md::108"></span>Alternatively, to make it easier to find your key, upload your key
onto the interwebs.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:111"><code>gpg --keyserver subkeys.pgp.net --send-keys &lt;Key ID&gt;</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:113"><span data-line="8;passwords.md:350;encrypted_mail.md::113"></span>To have your friend get your key, they just have to do the reverse
process, where <span data-line="8;passwords.md:350;encrypted_mail.md::114"></span>&#8220;thriller@gmail.com&#8221;<span data-line="8;passwords.md:350;encrypted_mail.md::114"></span> is the email that you listed
in your key<span data-line="8;passwords.md:350;encrypted_mail.md::115"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::115"></span>s UID.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:117"><code>gpg --keyserver subkeys.pgp.net --search-keys thriller@gmail.com</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:119"><span data-line="8;passwords.md:350;encrypted_mail.md::119"></span>Once your friend has found your key, they just have to import it
into your keyring.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:122"><code>gpg --import &lt;friend&#39;s key ID&gt;</code></pre></li></ol>

<p data-line="8;passwords.md:350;encrypted_mail.md:124"><span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>Once that<span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>s done, and you<span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>ve tried to import your friend<span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::124"></span>s key, check to
see if their key is in your keyring.
</p>
<pre class="para-block para-block" data-line="8;passwords.md:350;encrypted_mail.md:127"><code>gpg --list-keys</code></pre>
<p data-line="8;passwords.md:350;encrypted_mail.md:129"><span data-line="8;passwords.md:350;encrypted_mail.md::129"></span>If it<span data-line="8;passwords.md:350;encrypted_mail.md::129"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::129"></span>s there, then everything is perfect! Open mutt and compose a mail
to your buddy. Then, on the last screen, instead of pressing <span data-line="8;passwords.md:350;encrypted_mail.md::130"></span>&#8220;y“ to
send your mail, press &#8221;<span data-line="8;passwords.md:350;encrypted_mail.md::131"></span>p<span data-line="8;passwords.md:350;encrypted_mail.md::131"></span>&#8220;. You will then get a couple of options for
what to do with your mail. Choose &#8221;<span data-line="8;passwords.md:350;encrypted_mail.md::132"></span>b<span data-line="8;passwords.md:350;encrypted_mail.md::132"></span>&quot;<span data-line="8;passwords.md:350;encrypted_mail.md::132"></span>–both sign and encrypt. You will
be prompted for your password and for your friend<span data-line="8;passwords.md:350;encrypted_mail.md::133"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::133"></span>s key. Enter them and
everything should go smoothly. Now you<span data-line="8;passwords.md:350;encrypted_mail.md::134"></span>&#39;<span data-line="8;passwords.md:350;encrypted_mail.md::134"></span>re sending encrypted mail!
</p><h2 id="readings-and-other-references"  data-line="8;passwords.md:352" ><span data-line="8;passwords.md::352"></span>Readings and other references</h2>
<p data-line="8;passwords.md:354"><span data-line="8;passwords.md::354"></span> A brief introduction to what encryption is and the various problems
    associated with it for most people:
    http://www.washingtonpost.com/blogs/wonkblog/wp/2013/06/14/nsa-proof-encryption-exists-why-doesnt-anyone-use-it/
</p>
<p class="indent" data-line="8;passwords.md:358"><span data-line="8;passwords.md::358"></span>More on /etc/passwd: http://www.linfo.org/etc-passwd.html
</p>
<p class="indent" data-line="8;passwords.md:360"><span data-line="8;passwords.md::360"></span>An introduction to John the Ripper: http://www.admin-magazine.com/Articles/John-the-Ripper
</p>
<p class="indent" data-line="8;passwords.md:362"><span data-line="8;passwords.md::362"></span>`<span data-line="8;passwords.md::362"></span>`<span data-line="8;passwords.md::362"></span>GnuPG.<span data-line="8;passwords.md::362"></span>&quot;<span data-line="8;passwords.md::362"></span> Gentoo Wiki. N.p., n.d. Web. 15 July 2014.
<span data-line="8;passwords.md::363"></span><<span data-line="8;passwords.md::363"></span>http://wiki.gentoo.org/wiki/GnuPG<span data-line="8;passwords.md::363"></span>><span data-line="8;passwords.md::363"></span>.
</p>
<p class="indent" data-line="8;passwords.md:365"><span data-line="8;passwords.md::365"></span>`<span data-line="8;passwords.md::365"></span>`<span data-line="8;passwords.md::365"></span>John The Ripper.<span data-line="8;passwords.md::365"></span>&quot;<span data-line="8;passwords.md::365"></span> Juggernaut AppSec Wiki. N.p., n.d. Web. 15 July
2014. <span data-line="8;passwords.md::366"></span><<span data-line="8;passwords.md::366"></span>http://juggernaut.wikidot.com/jtr<span data-line="8;passwords.md::366"></span>><span data-line="8;passwords.md::366"></span>.
</p>
<p class="indent" data-line="8;passwords.md:368"><span data-line="8;passwords.md::368"></span>`<span data-line="8;passwords.md::368"></span>`<span data-line="8;passwords.md::368"></span>MuttGuide/UseGPG.<span data-line="8;passwords.md::368"></span>&quot;<span data-line="8;passwords.md::368"></span> Mutt. N.p., Dec. 2013. Web. 15 July 2014.
<span data-line="8;passwords.md::369"></span><<span data-line="8;passwords.md::369"></span>http://dev.mutt.org/trac/wiki/MuttGuide/UseGPG<span data-line="8;passwords.md::369"></span>><span data-line="8;passwords.md::369"></span>.
</p>
<p class="indent" data-line="8;passwords.md:371"><span data-line="8;passwords.md::371"></span>`<span data-line="8;passwords.md::371"></span>`<span data-line="8;passwords.md::371"></span>SSH/OpenSSH/Keys.<span data-line="8;passwords.md::371"></span>&quot;<span data-line="8;passwords.md::371"></span> Ubuntu Documentation. N.p., n.d. Web. 15 July
2014. <span data-line="8;passwords.md::372"></span><<span data-line="8;passwords.md::372"></span>https://help.ubuntu.com/community/SSH/OpenSSH/Keys<span data-line="8;passwords.md::372"></span>><span data-line="8;passwords.md::372"></span>.
</p>
<p class="indent" data-line="8;passwords.md:374"><span data-line="8;passwords.md::374"></span>`<span data-line="8;passwords.md::374"></span>`<span data-line="8;passwords.md::374"></span>Symmetric Key Algorithm.<span data-line="8;passwords.md::374"></span>&quot;<span data-line="8;passwords.md::374"></span> Wikipedia. Wikimedia Foundation, 06 Nov.
2013. Web. 15 July 2014
</p>
<p class="indent" data-line="8;passwords.md:377"><span data-line="8;passwords.md::377"></span>`<span data-line="8;passwords.md::377"></span>`<span data-line="8;passwords.md::377"></span>Why AES Is Not Used for Secure Hashing, Instead of SHA-x?<span data-line="8;passwords.md::377"></span>&quot;<span data-line="8;passwords.md::377"></span> Stack
Exchange. N.p., 12 Oct. 2011. Web. 15 July 2014.
<span data-line="8;passwords.md::379"></span><<span data-line="8;passwords.md::379"></span>http://security.stackexchange.com/questions/8048/why-aes-is-not-used-for-secure-hashing-instead-of-sha-x<span data-line="8;passwords.md::379"></span>><span data-line="8;passwords.md::379"></span>.
</p>
<p class="indent" data-line="8;passwords.md:381"><span data-line="8;passwords.md::381"></span>`<span data-line="8;passwords.md::381"></span>`<span data-line="8;passwords.md::381"></span>`<span data-line="8;passwords.md::381"></span>`<span data-line="8;passwords.md::381"></span>Password“ Unseated by <span data-line="8;passwords.md::381"></span>`<span data-line="8;passwords.md::381"></span>`<span data-line="8;passwords.md::381"></span>123456” on SplashData<span data-line="8;passwords.md::381"></span>&#39;<span data-line="8;passwords.md::381"></span>s Annual
<span data-line="8;passwords.md::382"></span>`<span data-line="8;passwords.md::382"></span>`<span data-line="8;passwords.md::382"></span>Worst Passwords“ List.” SplashData, n.d. Web. 14 July 2014.
</p>
<p class="indent" data-line="8;passwords.md:384"><span data-line="8;passwords.md::384"></span>Ellingwood, Justin. <span data-line="8;passwords.md::384"></span>`<span data-line="8;passwords.md::384"></span>`<span data-line="8;passwords.md::384"></span>How To Use PAM to Configure Authentication on an
Ubuntu 12.04 VPS.<span data-line="8;passwords.md::385"></span>&quot;<span data-line="8;passwords.md::385"></span> DigitalOcean. N.p., 3 Oct. 2013. Web. 14 July 2014.
</p>
<p class="indent" data-line="8;passwords.md:387"><span data-line="8;passwords.md::387"></span>Ellingwood, Justin. <span data-line="8;passwords.md::387"></span>`<span data-line="8;passwords.md::387"></span>`<span data-line="8;passwords.md::387"></span>How To Use Passwd and Adduser to Manage
Passwords on a Linux VPS.<span data-line="8;passwords.md::388"></span>&quot;<span data-line="8;passwords.md::388"></span> DigitalOcean. N.p., 17 June 2014. Web. 15
July 2014.
</p>
<p class="indent" data-line="8;passwords.md:391"><span data-line="8;passwords.md::391"></span>Muffett, Alec. <span data-line="8;passwords.md::391"></span>`<span data-line="8;passwords.md::391"></span>`<span data-line="8;passwords.md::391"></span>CrackLib: A ProActive Password Sanity Library.<span data-line="8;passwords.md::391"></span>&quot;<span data-line="8;passwords.md::391"></span> N.p.,
14 Dec. 1997. Web. 14 July 2014.
<span data-line="8;passwords.md::393"></span><<span data-line="8;passwords.md::393"></span>ftp://coast.cs.purdue.edu/pub/tools/unix/libs/cracklib/cracklib.2.7.README<span data-line="8;passwords.md::393"></span>><span data-line="8;passwords.md::393"></span>.
</p>
<p class="indent" data-line="8;passwords.md:395"><span data-line="8;passwords.md::395"></span>NixCraft. <span data-line="8;passwords.md::395"></span>`<span data-line="8;passwords.md::395"></span>`<span data-line="8;passwords.md::395"></span>Linux: HowTo Encrypt And Decrypt Files With A Password.<span data-line="8;passwords.md::395"></span>&quot;<span data-line="8;passwords.md::395"></span>
NixCraft. NixCraft, 8 June 2012. Web. 15 July 2014.
<span data-line="8;passwords.md::397"></span><<span data-line="8;passwords.md::397"></span>http://www.cyberciti.biz/tips/linux-how-to-encrypt-and-decrypt-files-with-a-password.html<span data-line="8;passwords.md::397"></span>><span data-line="8;passwords.md::397"></span>.
</p>
<p class="indent" data-line="8;passwords.md:399"><span data-line="8;passwords.md::399"></span>Pillai, Sarath. <span data-line="8;passwords.md::399"></span>`<span data-line="8;passwords.md::399"></span>`<span data-line="8;passwords.md::399"></span>How Are Passwords Stored in Linux (Understanding
Hashing with Shadow Utils).<span data-line="8;passwords.md::400"></span>&quot;<span data-line="8;passwords.md::400"></span> Slashroot.in. N.p., 24 Apr. 2013. Web. 15
July 2014.
<span data-line="8;passwords.md::402"></span><<span data-line="8;passwords.md::402"></span>http://www.slashroot.in/how-are-passwords-stored-linux-understanding-hashing-shadow-utils<span data-line="8;passwords.md::402"></span>><span data-line="8;passwords.md::402"></span>.
</p>
<p class="indent" data-line="8;passwords.md:404"><span data-line="8;passwords.md::404"></span>Srivistava, Vishal. <span data-line="8;passwords.md::404"></span>`<span data-line="8;passwords.md::404"></span>`<span data-line="8;passwords.md::404"></span>Understanding and Configuring PAM.<span data-line="8;passwords.md::404"></span>&quot;<span data-line="8;passwords.md::404"></span>
DeveloperWorks. IBM, 10 Mar. 2009. Web. 15 July 2014.
</p>
<p class="indent" data-line="8;passwords.md:407"><span data-line="8;passwords.md::407"></span>Wilson, Gary, Jr. <span data-line="8;passwords.md::407"></span>`<span data-line="8;passwords.md::407"></span>`<span data-line="8;passwords.md::407"></span>Using CrackLib to Require Stronger Passwords.<span data-line="8;passwords.md::407"></span>&quot;<span data-line="8;passwords.md::407"></span>
Gary Wilson Jr. N.p., 26 Aug. 2006. Web. 15 July 2014.
</p>
</body>
</html>
